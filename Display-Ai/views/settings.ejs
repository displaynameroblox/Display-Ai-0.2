<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Settings</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    body{background:#0b0b0b;color:#eee;font-family:Inter,system-ui,sans-serif;padding:18px}
    form{background:#0f0f0f;padding:16px;border-radius:10px;max-width:800px}
    input, textarea, select { width:100%; padding:10px; margin-top:8px; border-radius:8px; border:1px solid #222; background:#0b0b0b; color:#fff }
    button{background:#f55;color:#fff;padding:10px 14px;border-radius:9px;border:none;margin-top:10px}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
  </style>
</head>
<body>
  <a href="/" style="color:#fff">‚Üê Back</a>
  <h2>Settings for <%= username %></h2>

  <form id="settingsForm">
    <label>AI Display Name
      <input name="aiName" value="<%= user.aiName %>" />
    </label>

    <label>Personality (system instruction)
      <textarea name="personality" rows="6"><%= user.personality || "" %></textarea>
    </label>

    <div class="row">
      <label>Theme
        <select name="theme">
          <option value="dark" <%= user.theme==='dark'?'selected':'' %>>Dark</option>
          <option value="light" <%= user.theme==='light'?'selected':'' %>>Light</option>
        </select>
      </label>

      <label>Mood
        <select name="mood">
          <option value="neutral">Neutral</option>
          <option value="happy">Happy</option>
          <option value="sad">Sad</option>
          <option value="playful">Playful</option>
        </select>
      </label>
    </div>

    <button type="submit">Save Settings</button>
  </form>

<script>
  const form = document.getElementById("settingsForm");
  form.addEventListener("submit", async (e) => {
    e.preventDefault();
    const data = new FormData(form);
    const body = Object.fromEntries(data.entries());
    // send to API endpoint
    const res = await fetch("/api/settings", {
      method: "POST",
      headers: {"Content-Type":"application/json"},
      body: JSON.stringify({ username: "<%= username %>", ...body })
    });
    if (res.ok) {
      alert("Saved!");
      location.href = "/";
    } else {
      alert("Failed to save settings");
    }
  });
</script>
</body>
</html>